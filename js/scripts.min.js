function startGame(){$('.instruction').hide(),$('#timer').show(),$('#recipe_list').show(),$('#start').off('click',startGame),$('#start').hide(),getList(),arrowDown()}function getList(){for(var a='',b='<img src=\''+recipe[0].img+'\'>',c=1;totalRecipe>c;c++)a+='<li class=\'pannkakor\' id=\''+recipe[c].id+'\'>',a+='<img src=\''+recipe[c].img+'\'>',a+='</li>';$('#ingredients').html(a),$('#recipe').html(b)}function getIngredients(){for(var a='',b=1;totalRecipe>b;b++)a+='<img src=\''+recipe[b].img+'\' class=\'draggableItem ok '+recipe[b].ingr+'\' id=\''+recipe[b].id+'\'>';$('#items').html(a)}function startTimer(){timer=setInterval(countTime,1e3)}function countTime(){timerCount++;var a=Math.floor(timerCount/60),b=Math.floor(a/60);60>a?$('#timer_text').html(padNumber(a)+':'+padNumber(timerCount-60*a)):$('#timer_text').html(padNumber(b)+':'+padNumber(a-60*b)+':'+padNumber(timerCount-60*a))}function padNumber(a){return 10>a?'0'+a:a}function dragAndDrop(){$('.draggableItem').draggable({revert:function(a){if(!a){var b='<img src=\'../img/normal.png\'>';return $('#face').html('<img src=\'../img/fail.png\'>'),setTimeout(function(){$('#face').html(b)},1e3),!0}}}),$('.kastrull').droppable({accept:'.ok',drop:function(a,b){for(var c=b.draggable[0].id,d='#'+c,e=1;totalRecipe>e;e++)if(recipe[e].id==c){$(d).addClass('done'),b.draggable.hide(),$('.star').show().animate({bottom:'+=150px'},'slow',function(){$(this).removeAttr('style')});var f='<img src=\'../img/normal.png\'>';$('#face').html('<img src=\'../img/success.png\'>'),setTimeout(function(){$('#face').html(f)},1e3)}4==$('.done').length&&(stopTimer(),setTimeout(finnishedGame,800))}})}function stopTimer(){clearInterval(timer)}function arrowDown(){for(i=0;i<3;i++)$('#arrowDown').animate({top:'+=40px'},450).delay(150),$('#arrowDown').animate({top:'-=40px'},450);$('#arrowDown').fadeOut(),setTimeout(startTimer,4150),setTimeout(dragAndDrop,4150),setTimeout(go,3150)}function go(){$('.go').fadeIn('fast').delay(1e3).fadeOut('fast')}function finnishedGame(){$('#finnishedPancakes').animate({height:'60%',top:'20%',left:'10%',opacity:1},{duration:500}),$('#finnished').fadeIn(),window.setTimeout(function(){$('#goodJob').show()},600),setTimeout(result,3500)}function result(){playerName=localStorage.getItem('playerName'),playerTime=document.getElementById('timer_text').innerHTML,$.ajax({url:'save.php',type:'POST',data:{name:playerName,time:playerTime},success:function(a){ajax.open('GET','players.xml',!0),ajax.send()}}),ajax.onreadystatechange=function(){4==ajax.readyState&&200==ajax.status&&parseXML()},$('#wrapper').hide(),$('#result').fadeIn('slow');var a='<img src=\''+recipe[0].img+'\'>';$('.recipeImg').html(a);var b='<p>Bra jobbat, '+playerName+'!</p>';b+='<p>Din tid Ã¤r '+playerTime+'</p>',$('#playerScore').html(b),$('.playAgain').on('click',function(){window.location='index.php?reload=true'})}function parseXML(){var a=!!document.documentMode,b=!a&&!!window.StyleMedia;if(1==a||1==b)$('p.ieNotSupported').show(),$('.highscore').hide();else{var c=ajax.responseXML,d=c.getElementsByTagName('player'),e=(c.getElementsByTagName('name'),c.getElementsByTagName('time'),''),f=0;do e+='<tr>',e+='<td><img src="../img/star-green.png" alt="greenstar">'+d[f].children[0].innerHTML+'</td>',e+='<td class="highscore">'+d[f].children[1].innerHTML+'</td></tr>',f++;while(3>f);$('#ranking').html(e)}}var timer,points=0,timerCount=0,correctItems=0,recipe,currentRecipe=0,totalRecipe=0,id='',playersList,playerName,playerTime,ajax=new XMLHttpRequest,values=$(this).serialize();$(document).ready(function(){$('#send').click(function(a){a.preventDefault(),startGame();var b=$('#name').val();localStorage.setItem('playerName',b)}),$.getJSON('../recipes.json',function(a){recipe=a.recipe,totalRecipe=recipe.length,getIngredients(),window.location.href.indexOf('reload=true')>-1?startGame():(localStorage.clear(),$('.instruction').show())})});